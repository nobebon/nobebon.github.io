  <html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      var tableData, linesData, data;
      var tableChart, linesChart;
      var linesDataView;
      var tableOptions = {'width': '100%', 'height': '100%'};
      var linesOptions = {'width': '100%', 'height': '100%'};

      google.charts.load('current', {'packages':['corechart', 'table']});
      google.charts.setOnLoadCallback(loadData);

      function loadData() {
        var queryString = encodeURIComponent('SELECT B,F,G,H,I,L,M,N,O LIMIT 20 OFFSET 0');
        var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1-eagdAWmrYM0Q8Srp8CiCFvr5HaggIzdg9FtvjLvFM4/gviz/tq?sheet=Sheet1&tq=' + queryString);
        query.send(handleSampleDataQueryResponse);
      }


      var classicOptions = {
        title: 'Evolution des points obtenus par Team et par Game',
        width: '100%',
        height: '100%',
        
        series: {
          0: {targetAxisIndex: 0},
          1: {targetAxisIndex: 1}
        },
        vAxes: {0: {title: 'Points'}},
        hAxis: {
          ticks: []
        },
        vAxis: {
          viewWindow: {
            max: 30
          }
        }
      };

      var materialOptions = {
        chart: {
          title: 'Evolution des points obtenus par Team et par Game'
        },
        width: '100%',
        height: '100%',
        series: {
          // Gives each series an axis name that matches the Y-axis below.
          0: {axis: 'points'},
          1: {axis: 'points'},
          2: {axis: 'points'},
          3: {axis: 'points'},
          4: {axis: 'points'},
          5: {axis: 'points'},
          6: {axis: 'points'},
          7: {axis: 'points'},
          8: {axis: 'points'},
          9: {axis: 'points'},
          10: {axis: 'points'},
          11: {axis: 'points'},
          12: {axis: 'points'},
          13: {axis: 'points'},
          14: {axis: 'points'},
          15: {axis: 'points'},
          16: {axis: 'points'},
          17: {axis: 'points'},
          18: {axis: 'points'},
          19: {axis: 'points'}
        },
        axes: {
          // Adds labels to each axis; they don't have to match the axis names.
          y: {
            points: {label: 'Points'}
          }
        }
      };


      function handleSampleDataQueryResponse(response) {
        if (response.isError()) {
          alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
          return;
        }

        tableData = response.getDataTable();
        
        tableData.ng[0].label = 'Team';
        tableData.ng[1].label = 'W1G1';
        tableData.ng[2].label = 'W1G2';
        tableData.ng[3].label = 'W1G3';
        tableData.ng[4].label = 'W1G4';
        tableData.ng[5].label = 'W2G1';
        tableData.ng[6].label = 'W2G2';
        tableData.ng[7].label = 'W2G3';
        tableData.ng[8].label = 'W2G4';


        data = new google.visualization.DataTable();
        data.addColumn('string', 'Week/Game');
        
        for (var i = 0; i < tableData.og.length; i++) {
          data.addColumn('number', tableData.og[i].c[0].v);
        }

        var rows = [];
        for (var i = 1; i < tableData.ng.length; i++) {
          var row = [];
          row.push(tableData.ng[i].label);
          for (var j = 0; j < tableData.og.length; j++) {
            row.push(tableData.og[j].c[i]);
          }

          rows.push(row);
        }

        data.addRows(rows);

        linesChart = new google.visualization.LineChart(document.getElementById('lines_div'));
        linesChart.draw(data, materialOptions);

        // tableChart = new google.visualization.Table(document.getElementById('table_div'));
        // tableChart.draw(tableData, tableOptions);


        // linesData = new google.visualization.DataTable();
        // linesData.addColumn('string', tableData.ng[0].label);
        // var linesDataRows = [];
        // for (var i = 0; i < tableData.hc.length; i++) {
        //   linesData.addColumn('number', tableData.hc[i][0].Cf);
        // }
        // for (var i = 1; i < tableData.ng.length; i++) {
        //   var linesDataRow = [];
        //   linesDataRow.push(tableData.ng[i].label);
        //   for (var j = 0; j < tableData.og.length; j++) {
        //     linesDataRow.push(tableData.og[j].c[i]);
        //   }
        //   linesDataRows.push(linesDataRow);
        // }
        // linesData.addRows(linesDataRows);


        // linesChart = new google.visualization.LineChart(document.getElementById('lines_div'));
        // linesChart.draw(linesData, linesOptions);
        // console.log(data.ng[1].label);

        // google.visualization.events.addListener(table, 'select', function() {
        //   var row = table.getSelection()[0].row;
        //   alert('You selected ' + data.getValue(row, 0));
        // });

        // linesDataView = linesData;

        // google.visualization.events.addListener(linesChart, 'click', function(evt) {
        //   var legendPrefix = "legendentry#";
        //   // console.log(evt);
        //   // console.log(evt.targetID);
        //   // console.log(evt.targetID.indexOf(legendPrefix));
        //   if (evt.targetID.indexOf(legendPrefix) == 0) {
        //     // index of clicked legend entry
        //     var idx = evt.targetID.substring(legendPrefix.length);
        //     // console.log(evt.targetID.substring(legendPrefix.length));

        //     // // Show line
        //     // if (linesOptions.series[idx].lineDashStyle && linesOptions.series[idx].lineDashStyle[0] == 0) {
        //     //     linesOptions.series[idx].lineDashStyle = linesOptions.series[idx].originalLineDashStyle;
        //     // }
        //     // // Hide line
        //     // // ( Set the first value of lineDashStyle as 0,
        //     // //   and second as something that greater than 0 )
        //     // else {  
        //     //     linesOptions.series[idx].originalLineDashStyle = linesOptions.series[idx].lineDashStyle;
        //     //     linesOptions.series[idx].lineDashStyle = [0, 1];
        //     // }

        //     // linesChart.draw(linesData, linesOptions);
 
        //     // console.log("index: " + idx);

        //     // linesDataView = new google.visualization.DataView(tableData);
        //     linesDataView = new google.visualization.DataView(linesData);
        //     console.log(linesDataView);
        //     // console.log(idx);
        //     // linesDataView.hideRows([parseInt(idx)]);
        //     linesDataView.hideColumns([parseInt(idx)]);
        //     console.log(linesDataView);
            
        //     linesChart.draw(linesDataView, linesOptions);

        //   }

        // });

      }

      // function selectHandler() {
      //   var selectedItem = chart.getSelection()[0];
      //   var value = data.getValue(selectedItem.row, 0);
      //   alert('The user selected ' + value);
      // }

    </script>
  </head>
  <body>
    <div id="lines_div" style="width:100%; height:100%"></div>
  </body>
</html>
