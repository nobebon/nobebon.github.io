  <html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      var data;
      var chart;
      // var options = {'width': '100%', 'height': '100%'};
      var options = {
        chart: {
          title: 'Evolution des points obtenus par Team et par Game'
        },
        width: '100%',
        height: '100%',
        colors: ['#3366cc', '#dc3912', '#ff9900', '#109618', '#990099', '#0099c6', '#dd4477', '#66aa00', '#b82e2e', '#316395', '#994499', '#22aa99', '#aaaa11', '#6633cc', '#e67300', '#8b0707', '#651067', '#329262', '#5574a6', '#3b3eac'],        
        // , '#b77322', '#16d620', '#b91383', '#f4359e', '#9c5935', '#a9c413', '#2a778d', '#668d1c', '#bea413', '#0c5922', '#743411']
        selectionMode: 'multiple',
        series: {
          0: {axis: 'points'},
          1: {axis: 'points'},
          2: {axis: 'points'},
          3: {axis: 'points'},
          4: {axis: 'points'},
          5: {axis: 'points'},
          6: {axis: 'points'},
          7: {axis: 'points'},
          8: {axis: 'points'},
          9: {axis: 'points'},
          10: {axis: 'points'},
          11: {axis: 'points'},
          12: {axis: 'points'},
          13: {axis: 'points'},
          14: {axis: 'points'},
          15: {axis: 'points'},
          16: {axis: 'points'},
          17: {axis: 'points'},
          18: {axis: 'points'},
          19: {axis: 'points'}
        },
        axes: {
          y: {
            points: {label: 'Points'}
          }
        }
      };

      google.charts.load('current', {'packages':['corechart', 'table', 'line']});
      google.charts.setOnLoadCallback(loadData);

      function loadData() {
        var queryString = encodeURIComponent('SELECT B,F,G,H,I,L,M,N,O LIMIT 20 OFFSET 0');
        var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1-eagdAWmrYM0Q8Srp8CiCFvr5HaggIzdg9FtvjLvFM4/gviz/tq?sheet=Sheet1&tq=' + queryString);
        query.send(handleDataQueryResponse);
      }

      function handleDataQueryResponse(res) {
        if (res.isError()) {
          alert('Error in query: ' + res.getMessage() + ' ' + res.getDetailedMessage());
          return;
        }

        data = res.getDataTable();
        
        data.ng[0].label = 'Team';
        for (var i = 1; i < data.ng.length; i++) {
          var weekNumber = Math.floor(parseInt(i - 1) / 4) + 1;
          var gameNumber = parseInt(i - 1) % 4 + 1;
          data.ng[i].label = "W" + weekNumber + "G" + gameNumber;
        }

        for (var i = 0; i < data.og.length; i++) {
          for (var j = 2; j < data.og[i].c.length; j++) {
            data.og[i].c[j].v = data.og[i].c[j].v + data.og[i].c[j-1].v;
            data.og[i].c[j].f = String(data.og[i].c[j].v);
          }
        }

        for (var i = 1; i < data.ng.length; i++) {
          var classement = data.getSortedRows([{column: i, desc:true}]);
          for (var j = 0; j < classement.length; j++) {
            data.og[classement[j]].c[i]['points'] = data.og[classement[j]].c[i].v;
            data.og[classement[j]].c[i].v = j + 1;
            data.og[classement[j]].c[i].f = String(data.og[classement[j]].c[i].v);
          }
        }

        // chart = new google.visualization.Table(document.getElementById('chart_div'));
        chart = new google.charts.Line(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="title" style="width:100%; height:15%">
      <h1>H1Z1 Tournament | France | October 2017 Results</h1>
    </div>
    <div id="chart_div" style="width:100%; height:50%"></div>
    <div id="links" style="width:100%; height:35%">
      <ul>
        <li><a href="./team-points-per-game.html">Evolution des points gagn√©s par Game</a></li>
        <li><a href="./team-classement.html">Evolution du classement</a></li>
      </ul>
    </div>
  </body>
</html>
